import{b as d,e as f}from"./index.d29c8e76.js";import{notification as t}from"./notification.ebb7e7a1.js";import{u as m}from"./auth.bb8238f6.js";const l=m(),r=f(()=>l.user),i=r.value&&r.value._id?r.value.scopes:[];var _=d(async({router:u,app:p})=>{u.beforeEach((e,v,s)=>{if(e&&e.fullPath==="/login"&&r.value._id||e&&e.fullPath==="/"&&r.value._id)return s("/dashboard"),!0;if(e.matched.some(a=>a.meta.auth)&&!r.value._id)return console.log(e),t("negative","Necesitas estar logueado para acceder a esta secci\xF3n","red-9"),l.doLogout(),s("/login"),!0;if(e.matched.some(a=>a.meta.available)){const a=e.meta.available;let o=!1;if(a.length>0&&i&&i.length>0){const n=i;for(const c of n)if(a&&!a.includes(c))o=!1;else{o=!0;break}if(!o)return t("negative","No tienes permiso para poder ver esta secci\xF3n de la app","red-9"),s(!1),!0}}if(e.path==="/login/"&&r.value._id)return s("/dashboard"),!0;s()})});export{_ as default};
