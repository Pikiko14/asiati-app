import{Q as P,a as x}from"./QForm.907399ed.js";import{Q as z}from"./QImg.012fabd5.js";import{Y as y,r as m,Z as _,_ as $,$ as u,ae as g,af as n,a2 as t,a1 as c,ag as w,a4 as h,ah as f,a3 as I,ai as L,aj as A,a5 as k,ak as D,al as S,am as Z,an as F,a0 as Q}from"./index.e94012db.js";import{u as b}from"./auth.4c1cf49a.js";import{notification as V}from"./notification.c885a505.js";const R=y({name:"RecoveryForm",props:{token:{type:String,required:!1,default:()=>""}},emits:["close-modal"],setup(e,{emit:s}){const l=m({password:"",token:e.token,confirmation_password:""}),p=_(),i=m(""),d=b(),o=m(!1),a=m(!1),v=()=>{s("close-modal")},q=async()=>{if(o.value=!0,e.token)return await C(),!1;try{const r=await d.initRecoveryPassword({email:i.value});r!=null&&r.success&&(V("positice",r==null?void 0:r.message,"primary"),v())}catch{}finally{o.value=!1}},C=async()=>{try{const r=await d.doChangePassword(l.value);r!=null&&r.success&&(V("positice",r==null?void 0:r.message,"primary"),v(),p.push({name:"login"}))}catch{}finally{o.value=!1}};return{email:i,loading:o,onSubmit:q,closeModal:v,recoveryData:l,showPassword:a}}}),B={class:"row d-flex align-center justify-center"},E={class:"col-12 text-center text-h5 text-weight-semi-bold"},U={key:0},M={key:1},N={class:"col-12 q-mt-lg"},j={key:0,class:"col-12"},O={key:1,class:"col-12"},T={key:2,class:"col-12"},Y={class:"col-12 q-mt-sm"},G={class:"col-12 q-mt-lg"},H=n("span",{class:"q-pl-sm text-accent"},"Regresar a Iniciar sesi\xF3n",-1);function J(e,s,l,p,i,d){return u(),g("div",B,[n("div",E,[e.token?(u(),g("span",M,"Ingresa tu nueva contrase\xF1a")):(u(),g("span",U," \xBFOlvidaste tu contrase\xF1a? "))]),n("div",N,[t(P,{class:"row full-width",onSubmit:e.onSubmit},{default:c(()=>[e.token?h("",!0):(u(),g("div",j,[t(w,{modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=o=>e.email=o),placeholder:"Ingresa tu correo electr\xF3nico",outlined:"",rounded:"",rules:[o=>!!o||"Este campo es requerido",o=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o)||"Ingresa un correo electr\xF3nico valido"]},null,8,["modelValue","rules"])])),e.token?(u(),g("div",O,[t(w,{type:e.showPassword?"text":"password",modelValue:e.recoveryData.password,"onUpdate:modelValue":s[2]||(s[2]=o=>e.recoveryData.password=o),placeholder:"**********",outlined:"",rounded:"",rules:[o=>!!o||"Este campo es requerido",o=>/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[$@#&!*-])[A-Za-z\d$@#&!*-]{8,}$/.test(o)||"Ingresa una contrase\xF1a valida"]},{append:c(()=>[t(f,{onClick:s[1]||(s[1]=o=>e.showPassword=!e.showPassword),flat:"",dense:"",rounded:"",icon:"img:images/eye.svg"})]),_:1},8,["type","modelValue","rules"])])):h("",!0),e.token?(u(),g("div",T,[t(w,{type:e.showPassword?"text":"password",modelValue:e.recoveryData.confirmation_password,"onUpdate:modelValue":s[4]||(s[4]=o=>e.recoveryData.confirmation_password=o),placeholder:"**********",outlined:"",rounded:"",rules:[o=>!!o||"Este campo es requerido",o=>/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[$@#&!*-])[A-Za-z\d$@#&!*-]{8,}$/.test(o)||"Ingresa una contrase\xF1a valida"]},{append:c(()=>[t(f,{onClick:s[3]||(s[3]=o=>e.showPassword=!e.showPassword),flat:"",dense:"",rounded:"",icon:"img:images/eye.svg"})]),_:1},8,["type","modelValue","rules"])])):h("",!0),n("div",Y,[t(f,{loading:e.loading,rounded:"",size:"12pt",label:"Recuperar contrase\xF1a","no-caps":"",unelevated:"",color:"primary",class:"full-width",type:"submit"},null,8,["loading"])]),n("div",G,[t(f,{onClick:e.closeModal,flat:"",rounded:"",size:"12pt","no-caps":"",unelevated:"",color:"trasnparent",class:"full-width"},{default:c(()=>[t(I,{style:{"margin-top":"-4px"},size:"15pt",class:"float-left",name:"img:/images/back.svg"}),H]),_:1},8,["onClick"])])]),_:1},8,["onSubmit"])])])}var K=$(R,[["render",J]]);const W=y({name:"LoginFormView",emits:["do-login"],props:{loading:Boolean},components:{RecoveryFormVue:K},setup(e,{emit:s}){const l=L(),p=_(),i=m(""),d=m(!1),o=m({username:null,password:null}),a=m(!1),v=()=>{s("do-login",o.value)};return A(()=>{l.path==="/recovery"&&(l.query.token||p.push({name:"login"}),l.query.token&&(a.value=!0,i.value=l.query.token))}),{token:i,onSubmit:v,loginData:o,showPassword:d,recoveryPassword:a}}}),X={class:"full-width full-height d-flex flex-center items-center"},ee={class:"col-12 text-center"},oe=n("div",{class:"col-12 q-mt-xl text-h4 text-weight-semi-bold text-center"},[F(" M\xF3dulo Financiero "),n("br"),F(" eCommerce ")],-1),se={class:"col-12 q-mt-xl"},ae=n("label",{for:""},"Correo electr\xF3nico",-1),te={class:"col-12"},ne=n("label",{for:""},"Contrase\xF1a",-1),re={class:"col-12 text-right"},le={class:"col-12 q-mt-xl"};function de(e,s,l,p,i,d){const o=k("RecoveryFormVue");return u(),g("section",X,[t(P,{onSubmit:e.onSubmit,class:"row q-px-xl"},{default:c(()=>[n("div",ee,[t(z,{src:"/images/logo.svg",width:"200px"})]),oe,n("div",se,[ae,t(w,{modelValue:e.loginData.username,"onUpdate:modelValue":s[0]||(s[0]=a=>e.loginData.username=a),placeholder:"Ingresa tu correo electr\xF3nico",outlined:"",rounded:"",rules:[a=>!!a||"Este campo es requerido",a=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a)||"Ingresa un correo electr\xF3nico valido"]},null,8,["modelValue","rules"])]),n("div",te,[ne,t(w,{type:e.showPassword?"text":"password",modelValue:e.loginData.password,"onUpdate:modelValue":s[2]||(s[2]=a=>e.loginData.password=a),placeholder:"**********",outlined:"",rounded:"",rules:[a=>!!a||"Este campo es requerido",a=>/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[$@#&!*-])[A-Za-z\d$@#&!*-]{8,}$/.test(a)||"Ingresa una contrase\xF1a valida"]},{append:c(()=>[t(f,{onClick:s[1]||(s[1]=a=>e.showPassword=!e.showPassword),flat:"",dense:"",rounded:"",icon:"img:images/eye.svg"})]),_:1},8,["type","modelValue","rules"])]),n("div",re,[n("span",{onClick:s[3]||(s[3]=a=>e.recoveryPassword=!0),class:"text-primary text-weight-medium font-12 cursor-pointer"},"Olvide mi contrase\xF1a")]),n("div",le,[t(f,{rounded:"",size:"12pt",label:"Iniciar sesi\xF3n","no-caps":"",unelevated:"",color:"primary",class:"full-width",type:"submit"})])]),_:1},8,["onSubmit"]),t(Z,{modelValue:e.recoveryPassword,"onUpdate:modelValue":s[5]||(s[5]=a=>e.recoveryPassword=a)},{default:c(()=>[t(D,{class:"round-10 recovery-card q-pa-lg"},{default:c(()=>[t(S,null,{default:c(()=>[t(o,{token:e.token,onCloseModal:s[4]||(s[4]=a=>e.recoveryPassword=!1)},null,8,["token"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ie=$(W,[["render",de]]);const ce=y({name:"LoginComponent",components:{LoginForm:ie},setup(){const e=_(),s=b(),l=m(!1);return{doLogin:async i=>{try{const d=await s.doLogin(i);d&&d.success&&e.push({name:"dashboard"})}catch{}},loading:l}}}),ue={class:"login-form row background"},me={class:"col-12 col-md-4 mobile-overflow"};function pe(e,s,l,p,i,d){const o=k("LoginForm");return u(),g("section",ue,[n("div",me,[t(o,{loading:e.loading,onDoLogin:e.doLogin,key:"login-form"},null,8,["loading","onDoLogin"])])])}var ge=$(ce,[["render",pe]]);const fe=y({name:"IndexPage",components:{Login:ge},setup(){return{}}});function ve(e,s,l,p,i,d){const o=k("Login");return u(),Q(x,{class:"login-page"},{default:c(()=>[t(o)]),_:1})}var ke=$(fe,[["render",ve]]);export{ke as default};
